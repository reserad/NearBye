{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/objectWithoutProperties\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _excluded = [\"focused\", \"index\", \"inputRefs\"];\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport { useEffect, useRef, useState } from \"react\";\nimport KeyboardAvoidingView from \"react-native-web/dist/exports/KeyboardAvoidingView\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-runtime\";\nexport var OTP = function OTP(props) {\n  var input = useRef(null);\n  var pinCount = props.pinCount;\n\n  var _useState = useState(new Array(pinCount).fill(\"\")),\n      _useState2 = _slicedToArray(_useState, 2),\n      otpValue = _useState2[0],\n      setOtpValue = _useState2[1];\n\n  var _useState3 = useState(0),\n      _useState4 = _slicedToArray(_useState3, 2),\n      selectedIndex = _useState4[0],\n      setSelectedIndex = _useState4[1];\n\n  var _useState5 = useState(new Array(pinCount).fill(null)),\n      _useState6 = _slicedToArray(_useState5, 2),\n      inputRefs = _useState6[0],\n      setInputRefs = _useState6[1];\n\n  var _useState7 = useState(0),\n      _useState8 = _slicedToArray(_useState7, 2),\n      nextInputIndex = _useState8[0],\n      setNextInputIndex = _useState8[1];\n\n  var handleChangeText = function handleChangeText(text, index) {\n    var newOtpValue = _toConsumableArray(otpValue);\n\n    newOtpValue[index] = text;\n    setOtpValue(newOtpValue);\n    var lastInputIndex = pinCount - 1;\n    var newInputIndex = 0;\n\n    if (!text) {\n      newInputIndex = index === 0 ? 0 : index - 1;\n    } else {\n      newInputIndex = index === lastInputIndex ? lastInputIndex : index + 1;\n    }\n\n    setNextInputIndex(newInputIndex);\n  };\n\n  useEffect(function () {\n    if (input.current) {\n      setTimeout(function () {\n        return input.current.focus();\n      }, 0);\n    }\n  }, [nextInputIndex]);\n\n  var SingleOTPElement = function SingleOTPElement(props) {\n    var focused = props.focused,\n        index = props.index,\n        inputRefs = props.inputRefs,\n        rest = _objectWithoutProperties(props, _excluded);\n\n    return _jsx(View, {\n      style: focused ? styles.SingleOTPElementFocused : styles.SingleOTPElement,\n      children: _jsx(TextInput, _objectSpread({\n        ref: nextInputIndex === index ? input : null,\n        keyboardType: \"numeric\",\n        textContentType: \"oneTimeCode\",\n        onChangeText: function onChangeText(text) {\n          return handleChangeText(text, index);\n        },\n        placeholder: \"0\",\n        style: styles.input\n      }, rest))\n    });\n  };\n\n  return _jsx(KeyboardAvoidingView, {\n    children: _jsx(View, {\n      style: {\n        flexDirection: 'row'\n      },\n      children: _jsx(_Fragment, {\n        children: new Array(pinCount).fill(\"\").map(function (_, index) {\n          return _jsx(SingleOTPElement, {\n            inputRefs: inputRefs,\n            index: index,\n            value: otpValue[index],\n            focused: selectedIndex === index\n          }, \"OTP-\" + index);\n        })\n      })\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  SingleOTPElement: {\n    height: 50,\n    width: 50,\n    marginHorizontal: 5,\n    borderStyle: 'solid',\n    borderWidth: 2,\n    borderColor: '#0086A4'\n  },\n  SingleOTPElementFocused: {\n    height: 50,\n    width: 50,\n    marginHorizontal: 5,\n    borderStyle: 'solid',\n    borderWidth: 2,\n    borderColor: '#240071'\n  },\n  input: {\n    flex: 1,\n    textAlign: 'center'\n  }\n});","map":{"version":3,"sources":["/Users/alecreser/Desktop/Projects/NearBye/components/OTP.tsx"],"names":["useEffect","useRef","useState","OTP","props","input","pinCount","Array","fill","otpValue","setOtpValue","selectedIndex","setSelectedIndex","inputRefs","setInputRefs","nextInputIndex","setNextInputIndex","handleChangeText","text","index","newOtpValue","lastInputIndex","newInputIndex","current","setTimeout","focus","SingleOTPElement","focused","rest","styles","SingleOTPElementFocused","flexDirection","map","_","StyleSheet","create","height","width","marginHorizontal","borderStyle","borderWidth","borderColor","flex","textAlign"],"mappings":"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","sourcesContent":["import { MutableRefObject, useEffect, useLayoutEffect, useRef, useState } from \"react\";\nimport { KeyboardAvoidingView, NativeSyntheticEvent, StyleSheet, TextInput, TextInputChangeEventData, TextInputKeyPressEventData, TouchableWithoutFeedback, View } from \"react-native\";\nimport usePrevious from \"../hooks/usePrevious\";\n\ntype OTPProps = {\n    pinCount: number;\n};\n\nexport const OTP = (props: OTPProps) => {\n    const input = useRef<TextInput | null>(null);\n    const {pinCount} = props;\n    const [otpValue, setOtpValue] = useState<string[]>(new Array(pinCount).fill(\"\"));\n    const [selectedIndex, setSelectedIndex] = useState(0);\n    const [inputRefs, setInputRefs] = useState<(TextInput | null)[]>(new Array(pinCount).fill(null));\n    const [nextInputIndex, setNextInputIndex] = useState(0);\n\n    const handleChangeText = (text: string, index: number) => {\n        const newOtpValue = [...otpValue];\n        newOtpValue[index] = text;\n        setOtpValue(newOtpValue);\n\n        const lastInputIndex = pinCount - 1;\n        let newInputIndex = 0;\n        if (!text) {\n            newInputIndex = index === 0 ? 0 : index-1;\n        } else {\n            newInputIndex = index === lastInputIndex ? lastInputIndex : index + 1;\n        }\n        \n        setNextInputIndex(newInputIndex);\n    }\n\n    useEffect(() => {\n        if (input.current) {\n            setTimeout(() => input.current!.focus(), 0)\n        }\n    }, [nextInputIndex]);\n\n    // const handleChangeText = (e: NativeSyntheticEvent<any>, index: number, value: string) => {\n    //     e.preventDefault();\n    //     console.log('hit');\n    //     let newOtpValue = [...otpValue];\n    //     newOtpValue[index] = value !== '' ? [...value].pop()!.toString() : value;\n    //     setOtpValue(newOtpValue);\n    //     if (index < inputRefs.length) {\n    //         focusField(index+1);\n    //     } else {\n    //         blurAllFields();\n    //     }\n    //     // setFocusedIndex(index);\n    // }\n\n    // const focusField = (index: number) => {\n    //     if (index < inputRefs.length) {\n    //         console.log('focusField');\n    //         setTimeout(() => (inputRefs[index] as TextInput).focus(), 0)\n    //         setSelectedIndex(index);\n    //     }\n    // }\n\n    // const blurAllFields = () => {\n    //     inputRefs.forEach((field: TextInput | null) => setTimeout(() => (field as TextInput).focus(), 0))\n    //     setSelectedIndex(-1);\n    // }\n\n    // const handleKeyPressTextInput = (e: NativeSyntheticEvent<any>, index: number, key: string) => {\n    //     e.preventDefault();\n    //     if (key === 'Backspace') {\n    //         if (!otpValue[index] && index > 0) {\n    //             handleChangeText(e, index - 1, '')\n    //             focusField(index - 1)\n    //         }\n    //     }\n    // }\n\n    const SingleOTPElement = (props: SingleOTPElementProps) => {\n        const { focused, index, inputRefs, ...rest } = props;\n    \n        return (\n            <View style={focused ? styles.SingleOTPElementFocused : styles.SingleOTPElement }>\n                {/* <TextInput\n                    ref={input}\n                    keyboardType=\"numeric\"\n                    onKeyPress={(e: NativeSyntheticEvent<TextInputKeyPressEventData>) => { handleKeyPressTextInput(e, index, e.nativeEvent.key) }}\n                    textContentType=\"oneTimeCode\"\n                    onChange={(e: NativeSyntheticEvent<TextInputChangeEventData>) => handleChangeText(e, index, e.nativeEvent.text)}\n                    placeholder=\"0\"\n                    style={styles.input}\n                    {...rest}\n                /> */}\n                <TextInput\n                    ref={nextInputIndex === index ? input : null}\n                    keyboardType=\"numeric\"\n                    textContentType=\"oneTimeCode\"\n                    onChangeText={text => handleChangeText(text, index)}\n                    placeholder=\"0\"\n                    style={styles.input}\n                    {...rest}\n                />\n            </View>\n        );\n    }\n    \n    return (\n        <KeyboardAvoidingView>\n            <View style={{flexDirection: 'row'}}>\n                <>\n                    {new Array(pinCount).fill(\"\").map((_, index) => {\n                        // const handleInputFocus = (element: ) => {\n                        //     if (elmnt.key === \"Delete\" || elmnt.key === \"Backspace\") {\n                        //       const next = elmnt.target.tabIndex - 2;\n                        //       if (next > -1) {\n                        \n                        //         elmnt.target.form.elements[next].focus()\n                        //       }\n                        //     }\n                        //     else {\n                        //       console.log(\"next\");\n                            \n                        //         const next = elmnt.target.tabIndex;\n                        //         if (next < 5) {\n                        //           elmnt.target.form.elements[next].focus()\n                        //         }\n                        //     }\n                        \n                        //   }\n\n                        return (\n                            <SingleOTPElement\n                                key={`OTP-${index}`}\n                                inputRefs={inputRefs}\n                                index={index}\n                                value={otpValue[index]}\n                                focused={selectedIndex === index}\n                            />\n                        );\n                    })}\n                </>\n            </View>\n                \n        </KeyboardAvoidingView>\n    );\n}\n\ntype SingleOTPElementProps = {\n    value: string;\n    index: number,\n    inputRefs: (TextInput | null) [],\n    focused: boolean;\n};\n\nconst styles = StyleSheet.create({\n\tSingleOTPElement: {\n        height: 50,\n        width: 50,\n        marginHorizontal: 5,\n        borderStyle: 'solid',\n        borderWidth: 2,\n        borderColor: '#0086A4'\n\t},\n    SingleOTPElementFocused: {\n        height: 50,\n        width: 50,\n        marginHorizontal: 5,\n        borderStyle: 'solid',\n        borderWidth: 2,\n        borderColor: '#240071'\n\t},\n    input: {\n        flex: 1,\n        textAlign: 'center'\n    }\n});"]},"metadata":{},"sourceType":"module"}